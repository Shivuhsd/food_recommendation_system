{% load static %}
{% load static tailwind_tags %}
<!DOCTYPE html>
<html lang="en">
	<head>
    <title>
        {% block title %}
            Anemia Personal Information
        {% endblock %}
    </title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
        <link rel="icon" href="{% static 'img/favicon.jpg' %}">
		{% tailwind_css %}
        <link href="https://cdn.jsdelivr.net/npm/flowbite@latest/dist/flowbite.min.css" rel="stylesheet">
        
        <style>
            .alert {
    transition: opacity 0.3s ease, transform 0.3s ease;
    position: absolute;
    width: 100%;
    margin: 0.5rem 0;
  }

  .alert-hidden {
    opacity: 0;
    transform: translateY(-10px);
    pointer-events: none; /* Optional: Prevents interaction when hidden */
  }
        </style>
    </head>
    <body>
    
        <!-- Django Messages with Tailwind alerts -->

        {% if messages %}
        <ul class="messages">
            {% for message in messages %}
            <div id="alert-2" class="alert flex items-center p-4 mb-4 
            {% if message.tags == 'error'%}
            text-red-800 rounded-lg bg-red-100
            {% elif message.tags == 'success'%}
            text-green-800 rounded-lg bg-green-100
            {% elif message.tags == 'info'%}
            text-blue-800 rounded-lg bg-blue-100
            {% elif message.tags == 'warning'%}
            text-yellow-800 rounded-lg bg-yellow-100
            {% endif %}" 
            role="alert">
                <svg class="flex-shrink-0 w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                </svg>
                <span class="sr-only">Info</span>
                <div class="ms-3 text-sm font-medium">
                  {{message}}
                </div>
                <button type="button" class="ms-auto -mx-1.5 -my-1.5 
                {% if message.tags == 'error'%}
                bg-red-50 text-red-500 rounded-lg focus:ring-2 focus:ring-red-400 p-1.5 hover:bg-red-200
                {% elif message.tags == 'success'%}
                bg-green-50 text-green-500 rounded-lg focus:ring-2 focus:ring-green-400 p-1.5 hover:bg-green-200
                {% elif message.tags == 'info'%}
                bg-blue-50 text-blue-500 rounded-lg focus:ring-2 focus:ring-blue-400 p-1.5 hover:bg-blue-200
                {% elif message.tags == 'warning'%}
                bg-yellow-50 text-yellow-500 rounded-lg focus:ring-2 focus:ring-yellow-400 p-1.5 hover:bg-yellow-200
                {% endif %}
                 inline-flex items-center justify-center h-8 w-8 " data-dismiss-target="#alert-2" aria-label="Close">
                  <span class="sr-only">Close</span>
                  <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                  </svg>
                </button>
              </div>

            <!-- <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li> -->
            {% endfor %}
        </ul>
        {% endif %}









        <!-- -------------- -->

        <nav class="border-gray-200 bg-gray-50 dark:bg-gray-800 dark:border-gray-700">
        <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-2">
        <a href="#" class="flex items-center space-x-3 rtl:space-x-reverse">
            <img src="https://flowbite.com/docs/images/logo.svg" class="h-8" alt="Flowbite Logo" />
            <span class="self-center text-2xl font-semibold whitespace-nowrap dark:text-white">Anemia</span>
        </a>
        <button data-collapse-toggle="navbar-hamburger" type="button" class="bg-rose-500 inline-flex items-center justify-center py-1 px-2  text-lg text-black rounded-lg hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-black-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="navbar-hamburger" aria-expanded="false">
            <span class="sr-only">Open main menu</span>
            <a href="{% url 'userlogout' %}">Logout</a>
        </button>
        </div>
        </nav>
    

        <div class="container mx-auto mt-6">
            <p class="text-blue-500 font-light mb-3">Hey, why don't you let us know about you...</p>
            <ol class="flex items-center w-full text-sm font-medium text-center text-gray-500 dark:text-gray-400 sm:text-base">
                <li class="flex md:w-full items-center 
                {% block tikpersonal %}
        
                {% endblock %}
                sm:after:content-[''] after:w-full after:h-1 after:border-b after:border-gray-200 after:border-1 after:hidden sm:after:inline-block after:mx-6 xl:after:mx-10 dark:after:border-gray-700">
                    <span class="flex items-center after:content-['/'] sm:after:hidden after:mx-2 after:text-gray-200 dark:after:text-gray-500">
                        {% block personal %}
                        
                        {% endblock %}

                        Personal <span class="hidden sm:inline-flex sm:ms-2">Info</span>
                    </span>
                </li>
                <li class="flex md:w-full items-center
                {% block tickmedical %}
                
                 {% endblock %}
                 after:content-[''] after:w-full after:h-1 after:border-b after:border-gray-200 after:border-1 after:hidden sm:after:inline-block after:mx-6 xl:after:mx-10 dark:after:border-gray-700">
                    <span class="flex items-center after:content-['/'] sm:after:hidden after:mx-2 after:text-gray-200 dark:after:text-gray-500">
                        <span class="me-2">2</span>
                        {% block medical %}

                        {% endblock %}
                        
                        Medical <span class="hidden sm:inline-flex sm:ms-2">Info</span>
                    </span>
                </li>
            
                <li class="flex md:w-full items-center
                {% block tickdietry %}
                
                 {% endblock %}
                after:content-[''] after:w-full after:h-1 after:border-b after:border-gray-200 after:border-1 after:hidden sm:after:inline-block after:mx-6 xl:after:mx-10 dark:after:border-gray-700">
                    <span class="flex items-center after:content-['/'] sm:after:hidden after:mx-2 after:text-gray-200 dark:after:text-gray-500">
                        <span class="me-2">3</span>
                        {% block dietry %}
                        
                        {% endblock %}
                        Dietary<span class="hidden sm:inline-flex sm:ms-2">Info</span>
                    </span>
                </li>
                <li class="flex items-center">
                    <span class="me-2">3</span>
                    Confirmation
                </li>
            </ol>
        </div>


        <div class="container mx-auto p-4">
            {% block info %}
            <p class="font-light text-black my-3 text-lg">Get started with personal information.</p>
            <div class="bg-gray-50 py-3 px-3">
                    
            <p class="my-4 text-md font-light">Profile Photo</p>
            <img id="image_preview" class="rounded-full w-40 h-40 mb-4" src="#" alt="Image Preview" style="display:none; max-width: 100%; margin-top: 10px;">
        </div>
            <form method="POST" class="py-3 px-3" enctype="multipart/form-data">
                {% csrf_token %}
             
                    <div class="mb-6">
                        <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-white" for="file_input">Upload Profile Photo</label>
                        <input class="block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400"
                               aria-describedby="file_input_help"
                               id="file_input"
                               type="file"
                               accept="image/*"
                               name="profile_img"
                               onchange="previewImage(event)">
                        <p class="mt-1 text-sm text-gray-500 dark:text-gray-300" id="file_input_help">SVG, PNG, JPG or GIF (MAX. 800x400px).</p>
    <!-- <img  src="#" alt="image description"> -->
    
                        
                  
               
                </div>
                <div class="grid gap-6 mb-6 md:grid-cols-2">
                    <div>
                        <label for="first_name" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">First name</label>
                        <input type="text" id="first_name" name="first_name" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="John" required />
                    </div>
                    <div>
                        <label for="last_name" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Last name</label>
                        <input type="text" id="last_name" name="last_name" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="Doe" required />
                    </div>
                    <div>
                        <label for="dob" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Date of birth</label>
                        <div class="relative max-w-auto">
                            <div class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none">
                                <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"/>
                                </svg>
                            </div>
                            <input datepicker id="dob" name="dob" type="date" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full ps-10 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="Select date">
                        </div>
                    </div>  
                    <div>
                        <label for="phone_number" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Phone number</label>
                        <input type="tel" id="phone_number" name="phone_number" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="123-45-678"  required />
                    </div>
                    <div>
                        <label for="age" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Age</label>
                        <input type="number" id="age" name="age" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="15 Years" required />
                    </div>
                    <div>
                        <label for="height" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Height (cm)</label>
                        <input type="number" id="height" name="height" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="145" required />
                    </div>
                    <div>
                        <label for="weight" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Weight (kg)</label>
                        <input type="number" id="weight" name="weight" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="50.56" required />
                    </div>
                </div>
                <div class="grid gap-6 md:grid-cols-2">
                    <div class="mb-6">
                        <label for="address" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Complete address</label>
                        <textarea id="address" name="address" rows="4" class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="Write your thoughts here..."></textarea>
                    </div>
                    <div class="mb-6">
                        <label for="health_history" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Health conditions</label>
                        <textarea id="health_history" name="health_history" rows="4" class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="Write your thoughts here..."></textarea>
                    </div>
                </div>
                
                        
                <button type="submit" class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">Submit</button>
            </form>
            {% endblock %}
        </div>
	</body>
</html>
<script>
    document.addEventListener('DOMContentLoaded', function () {
      const dismissButtons = document.querySelectorAll('[data-dismiss-target]');
  
      dismissButtons.forEach(button => {
        button.addEventListener('click', function () {
          const targetSelector = this.getAttribute('data-dismiss-target');
          const targetElement = document.querySelector(targetSelector);
          if (targetElement) {
            targetElement.classList.add('alert-hidden');
            setTimeout(() => {
              targetElement.remove(); // Optional: Remove the element from the DOM after the transition
            }, 300); // Duration should match the CSS transition time
          }
        });
      });
    });
  </script>
  

{% block infoscript %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Function to calculate age from date of birth
        function calculateAge(dob) {
            const today = new Date();
            const birthDate = new Date(dob);
            let age = today.getFullYear() - birthDate.getFullYear();
            const monthDifference = today.getMonth() - birthDate.getMonth();
            if (monthDifference < 0 || (monthDifference === 0 && today.getDate() < birthDate.getDate())) {
                age--;
            }
            return age;
        }

        // Get references to the input fields
        const dateOfBirthInput = document.getElementById('default-datepicker');
        const ageInput = document.getElementById('age');

        // Event listener to handle changes in the date of birth input
        dateOfBirthInput.addEventListener('change', function () {
            const dob = dateOfBirthInput.value;
            console.log(dob)
            const age = calculateAge(dob);
            ageInput.value = age;
        });
    });


    function previewImage(event) {
    const file = event.target.files[0];
    const imagePreview = document.getElementById('image_preview');

    if (file) {
        // Check if the file is an image
        if (file.type.startsWith('image/')) {
            const reader = new FileReader();

            // Set up the FileReader to display the image
            reader.onload = function(e) {
                imagePreview.src = e.target.result;
                imagePreview.style.display = 'block'; // Show the image preview
            };

            reader.readAsDataURL(file);
        } else {
            alert('Please select a valid image file.');
            // Clear the file input
            event.target.value = '';
            imagePreview.style.display = 'none'; // Hide the image preview
        }
    } else {
        imagePreview.style.display = 'none'; // Hide the image preview if no file is selected
    }
}

</script>
{% endblock %}
